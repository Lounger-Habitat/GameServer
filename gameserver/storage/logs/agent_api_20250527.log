2025-05-27 09:41:48,461 - agent_api - INFO - Logging to file: /Users/own/Workspace/GameServer/gameserver/storage/logs/agent_api_20250527.log
2025-05-27 09:41:48,461 - agent_api - INFO - Storage path: /Users/own/Workspace/GameServer/gameserver/storage
2025-05-27 09:41:48,462 - agent_api - INFO - Memory space: /Users/own/Workspace/GameServer/gameserver/storage/memory
2025-05-27 09:41:48,462 - agent_api - INFO - Role path: /Users/own/Workspace/GameServer/gameserver/storage/configs/roles
2025-05-27 09:41:48,465 - rotk_api - INFO - Logging to file: /Users/own/Workspace/GameServer/gameserver/storage/logs/rotk_api_20250527.log
2025-05-27 09:41:48,465 - rotk_api - INFO - Storage path: /Users/own/Workspace/GameServer/gameserver/storage
2025-05-27 09:41:48,466 - rotk_api - INFO - Memory space: /Users/own/Workspace/GameServer/gameserver/storage/memory
2025-05-27 09:41:48,466 - rotk_api - INFO - Role path: /Users/own/Workspace/GameServer/gameserver/storage/configs/roles
2025-05-27 09:41:52,500 - uvicorn.error - INFO - Will watch for changes in these directories: ['/Users/own/Workspace/GameServer']
2025-05-27 09:41:52,501 - uvicorn.error - INFO - Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
2025-05-27 09:41:52,502 - uvicorn.error - INFO - Started reloader process [8520] using WatchFiles
2025-05-27 09:41:56,859 - agent_api - INFO - Logging to file: /Users/own/Workspace/GameServer/gameserver/storage/logs/agent_api_20250527.log
2025-05-27 09:41:56,860 - agent_api - INFO - Storage path: /Users/own/Workspace/GameServer/gameserver/storage
2025-05-27 09:41:56,861 - agent_api - INFO - Memory space: /Users/own/Workspace/GameServer/gameserver/storage/memory
2025-05-27 09:41:56,861 - agent_api - INFO - Role path: /Users/own/Workspace/GameServer/gameserver/storage/configs/roles
2025-05-27 09:41:56,864 - rotk_api - INFO - Logging to file: /Users/own/Workspace/GameServer/gameserver/storage/logs/rotk_api_20250527.log
2025-05-27 09:41:56,864 - rotk_api - INFO - Storage path: /Users/own/Workspace/GameServer/gameserver/storage
2025-05-27 09:41:56,865 - rotk_api - INFO - Memory space: /Users/own/Workspace/GameServer/gameserver/storage/memory
2025-05-27 09:41:56,865 - rotk_api - INFO - Role path: /Users/own/Workspace/GameServer/gameserver/storage/configs/roles
2025-05-27 09:41:56,873 - uvicorn.error - INFO - Started server process [8577]
2025-05-27 09:41:56,874 - uvicorn.error - INFO - Waiting for application startup.
2025-05-27 09:41:56,874 - uvicorn.error - INFO - Application startup complete.
2025-05-27 09:41:58,471 - uvicorn.error - INFO - ('127.0.0.1', 51890) - "WebSocket /ws/metaverse/env/1" [accepted]
2025-05-27 09:41:58,474 - gameserver.ws.endpoints.component.metaverse_connection_manager - INFO - New connection established for ID 1
2025-05-27 09:41:58,476 - uvicorn.error - ERROR - Exception in ASGI application
Traceback (most recent call last):
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/uvicorn/protocols/websockets/websockets_impl.py", line 243, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/routing.py", line 93, in app
    await func(session)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "/Users/own/Workspace/GameServer/gameserver/ws/endpoints/metaverse.py", line 139, in env_websocket
    await metaverse_websocket_handler(websocket, ws_type=ws_type, env_id=env_id)
  File "/Users/own/Workspace/GameServer/gameserver/ws/endpoints/metaverse.py", line 210, in metaverse_websocket_handler
    ).model_dump_json(ensure_ascii=False, indent=2)
      ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: BaseModel.model_dump_json() got an unexpected keyword argument 'ensure_ascii'
2025-05-27 09:41:58,686 - uvicorn.error - INFO - connection open
2025-05-27 09:41:58,686 - uvicorn.error - INFO - connection closed
2025-05-27 09:42:30,136 - watchfiles.main - INFO - 1 change detected
2025-05-27 09:42:30,141 - uvicorn.error - WARNING - WatchFiles detected changes in 'gameserver/ws/endpoints/metaverse.py'. Reloading...
2025-05-27 09:42:30,227 - uvicorn.error - INFO - Shutting down
2025-05-27 09:42:30,330 - uvicorn.error - INFO - Waiting for application shutdown.
2025-05-27 09:42:30,333 - uvicorn.error - INFO - Application shutdown complete.
2025-05-27 09:42:30,336 - uvicorn.error - INFO - Finished server process [8577]
2025-05-27 09:42:30,706 - watchfiles.main - INFO - 2 changes detected
2025-05-27 09:42:30,707 - uvicorn.error - WARNING - WatchFiles detected changes in 'gameserver/ws/endpoints/metaverse.py'. Reloading...
2025-05-27 09:42:35,015 - agent_api - INFO - Logging to file: /Users/own/Workspace/GameServer/gameserver/storage/logs/agent_api_20250527.log
2025-05-27 09:42:35,016 - agent_api - INFO - Storage path: /Users/own/Workspace/GameServer/gameserver/storage
2025-05-27 09:42:35,017 - agent_api - INFO - Memory space: /Users/own/Workspace/GameServer/gameserver/storage/memory
2025-05-27 09:42:35,017 - agent_api - INFO - Role path: /Users/own/Workspace/GameServer/gameserver/storage/configs/roles
2025-05-27 09:42:35,020 - rotk_api - INFO - Logging to file: /Users/own/Workspace/GameServer/gameserver/storage/logs/rotk_api_20250527.log
2025-05-27 09:42:35,020 - rotk_api - INFO - Storage path: /Users/own/Workspace/GameServer/gameserver/storage
2025-05-27 09:42:35,021 - rotk_api - INFO - Memory space: /Users/own/Workspace/GameServer/gameserver/storage/memory
2025-05-27 09:42:35,021 - rotk_api - INFO - Role path: /Users/own/Workspace/GameServer/gameserver/storage/configs/roles
2025-05-27 09:42:35,030 - uvicorn.error - INFO - Started server process [8891]
2025-05-27 09:42:35,030 - uvicorn.error - INFO - Waiting for application startup.
2025-05-27 09:42:35,031 - uvicorn.error - INFO - Application startup complete.
2025-05-27 09:42:35,131 - watchfiles.main - INFO - 3 changes detected
2025-05-27 09:42:37,638 - uvicorn.error - INFO - ('127.0.0.1', 51935) - "WebSocket /ws/metaverse/env/1" [accepted]
2025-05-27 09:42:37,639 - gameserver.ws.endpoints.component.metaverse_connection_manager - INFO - New connection established for ID 1
2025-05-27 09:42:37,640 - uvicorn.error - INFO - connection open
2025-05-27 09:42:58,019 - gameserver.ws.endpoints.metaverse - INFO - Received  message from {}
2025-05-27 09:42:58,024 - gameserver.ws.endpoints.metaverse - WARNING - Unhandled message type: 
2025-05-27 09:42:59,328 - gameserver.ws.endpoints.metaverse - INFO - Received  message from {}
2025-05-27 09:42:59,331 - gameserver.ws.endpoints.metaverse - WARNING - Unhandled message type: 
2025-05-27 09:42:59,625 - gameserver.ws.endpoints.metaverse - INFO - Received  message from {}
2025-05-27 09:42:59,626 - gameserver.ws.endpoints.metaverse - WARNING - Unhandled message type: 
2025-05-27 09:43:00,743 - gameserver.ws.endpoints.metaverse - INFO - Received  message from {}
2025-05-27 09:43:00,747 - gameserver.ws.endpoints.metaverse - WARNING - Unhandled message type: 
2025-05-27 09:43:07,646 - gameserver.ws.endpoints.metaverse - INFO - Received  message from {}
2025-05-27 09:43:07,650 - gameserver.ws.endpoints.metaverse - WARNING - Unhandled message type: 
2025-05-27 09:43:17,016 - gameserver.ws.endpoints.metaverse - INFO - Received  message from {}
2025-05-27 09:43:17,021 - gameserver.ws.endpoints.metaverse - WARNING - Unhandled message type: 
2025-05-27 09:43:17,805 - gameserver.ws.endpoints.metaverse - INFO - WebSocket disconnected for env (env: 1, agent: None, human: None)
2025-05-27 09:43:17,808 - gameserver.ws.endpoints.component.metaverse_connection_manager - INFO - Disconnected env_id 1
2025-05-27 09:43:17,810 - uvicorn.error - INFO - connection closed
2025-05-27 09:43:41,749 - agent_api - INFO - Logging to file: /Users/own/Workspace/GameServer/gameserver/storage/logs/agent_api_20250527.log
2025-05-27 09:43:41,750 - agent_api - INFO - Storage path: /Users/own/Workspace/GameServer/gameserver/storage
2025-05-27 09:43:41,750 - agent_api - INFO - Memory space: /Users/own/Workspace/GameServer/gameserver/storage/memory
2025-05-27 09:43:41,751 - agent_api - INFO - Role path: /Users/own/Workspace/GameServer/gameserver/storage/configs/roles
2025-05-27 09:43:41,754 - rotk_api - INFO - Logging to file: /Users/own/Workspace/GameServer/gameserver/storage/logs/rotk_api_20250527.log
2025-05-27 09:43:41,754 - rotk_api - INFO - Storage path: /Users/own/Workspace/GameServer/gameserver/storage
2025-05-27 09:43:41,754 - rotk_api - INFO - Memory space: /Users/own/Workspace/GameServer/gameserver/storage/memory
2025-05-27 09:43:41,755 - rotk_api - INFO - Role path: /Users/own/Workspace/GameServer/gameserver/storage/configs/roles
2025-05-27 09:43:45,831 - uvicorn.error - INFO - Started server process [9487]
2025-05-27 09:43:45,832 - uvicorn.error - INFO - Waiting for application startup.
2025-05-27 09:43:45,833 - uvicorn.error - INFO - Application startup complete.
2025-05-27 09:43:45,836 - uvicorn.error - INFO - Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2025-05-27 09:43:52,809 - uvicorn.error - INFO - Shutting down
2025-05-27 09:43:52,913 - uvicorn.error - INFO - Waiting for application shutdown.
2025-05-27 09:43:52,917 - uvicorn.error - INFO - Application shutdown complete.
2025-05-27 09:43:52,919 - uvicorn.error - INFO - Finished server process [9487]
2025-05-27 09:43:57,550 - agent_api - INFO - Logging to file: /Users/own/Workspace/GameServer/gameserver/storage/logs/agent_api_20250527.log
2025-05-27 09:43:57,551 - agent_api - INFO - Storage path: /Users/own/Workspace/GameServer/gameserver/storage
2025-05-27 09:43:57,551 - agent_api - INFO - Memory space: /Users/own/Workspace/GameServer/gameserver/storage/memory
2025-05-27 09:43:57,552 - agent_api - INFO - Role path: /Users/own/Workspace/GameServer/gameserver/storage/configs/roles
2025-05-27 09:43:57,555 - rotk_api - INFO - Logging to file: /Users/own/Workspace/GameServer/gameserver/storage/logs/rotk_api_20250527.log
2025-05-27 09:43:57,555 - rotk_api - INFO - Storage path: /Users/own/Workspace/GameServer/gameserver/storage
2025-05-27 09:43:57,556 - rotk_api - INFO - Memory space: /Users/own/Workspace/GameServer/gameserver/storage/memory
2025-05-27 09:43:57,556 - rotk_api - INFO - Role path: /Users/own/Workspace/GameServer/gameserver/storage/configs/roles
2025-05-27 09:44:03,359 - uvicorn.error - INFO - Started server process [9622]
2025-05-27 09:44:03,360 - uvicorn.error - INFO - Waiting for application startup.
2025-05-27 09:44:03,361 - uvicorn.error - INFO - Application startup complete.
2025-05-27 09:44:03,365 - uvicorn.error - INFO - Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2025-05-27 09:44:03,669 - uvicorn.error - INFO - Shutting down
2025-05-27 09:44:03,771 - uvicorn.error - INFO - Finished server process [9622]
2025-05-27 09:44:03,780 - uvicorn.error - ERROR - Traceback (most recent call last):
  File "/Users/own/.local/share/uv/python/cpython-3.13.2-macos-aarch64-none/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/Users/own/.local/share/uv/python/cpython-3.13.2-macos-aarch64-none/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "uvloop/loop.pyx", line 1512, in uvloop.loop.Loop.run_until_complete
  File "uvloop/loop.pyx", line 1505, in uvloop.loop.Loop.run_until_complete
  File "uvloop/loop.pyx", line 1379, in uvloop.loop.Loop.run_forever
  File "uvloop/loop.pyx", line 557, in uvloop.loop.Loop._run
  File "uvloop/loop.pyx", line 476, in uvloop.loop.Loop._on_idle
  File "uvloop/cbhandles.pyx", line 83, in uvloop.loop.Handle._run
  File "uvloop/cbhandles.pyx", line 63, in uvloop.loop.Handle._run
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 69, in serve
    with self.capture_signals():
         ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/own/.local/share/uv/python/cpython-3.13.2-macos-aarch64-none/lib/python3.13/contextlib.py", line 148, in __exit__
    next(self.gen)
    ~~~~^^^^^^^^^^
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 330, in capture_signals
    signal.raise_signal(captured_signal)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/own/.local/share/uv/python/cpython-3.13.2-macos-aarch64-none/lib/python3.13/asyncio/runners.py", line 157, in _on_sigint
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/routing.py", line 699, in lifespan
    await receive()
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/own/.local/share/uv/python/cpython-3.13.2-macos-aarch64-none/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-05-27 09:44:23,762 - agent_api - INFO - Logging to file: /Users/own/Workspace/GameServer/gameserver/storage/logs/agent_api_20250527.log
2025-05-27 09:44:23,763 - agent_api - INFO - Storage path: /Users/own/Workspace/GameServer/gameserver/storage
2025-05-27 09:44:23,764 - agent_api - INFO - Memory space: /Users/own/Workspace/GameServer/gameserver/storage/memory
2025-05-27 09:44:23,764 - agent_api - INFO - Role path: /Users/own/Workspace/GameServer/gameserver/storage/configs/roles
2025-05-27 09:44:23,767 - rotk_api - INFO - Logging to file: /Users/own/Workspace/GameServer/gameserver/storage/logs/rotk_api_20250527.log
2025-05-27 09:44:23,768 - rotk_api - INFO - Storage path: /Users/own/Workspace/GameServer/gameserver/storage
2025-05-27 09:44:23,768 - rotk_api - INFO - Memory space: /Users/own/Workspace/GameServer/gameserver/storage/memory
2025-05-27 09:44:23,768 - rotk_api - INFO - Role path: /Users/own/Workspace/GameServer/gameserver/storage/configs/roles
2025-05-27 09:44:27,846 - uvicorn.error - INFO - Started server process [9827]
2025-05-27 09:44:27,847 - uvicorn.error - INFO - Waiting for application startup.
2025-05-27 09:44:27,848 - uvicorn.error - INFO - Application startup complete.
2025-05-27 09:44:27,854 - uvicorn.error - INFO - Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2025-05-27 09:45:39,999 - uvicorn.error - INFO - ('127.0.0.1', 52087) - "WebSocket /ws/metaverse/env/1" [accepted]
2025-05-27 09:45:40,000 - gameserver.ws.endpoints.component.metaverse_connection_manager - INFO - New connection established for ID 1
2025-05-27 09:45:40,001 - uvicorn.error - INFO - connection open
2025-05-27 09:45:43,179 - gameserver.ws.endpoints.metaverse - INFO - Received  message from {}
2025-05-27 09:45:43,182 - gameserver.ws.endpoints.metaverse - WARNING - Unhandled message type: 
2025-05-27 09:45:52,065 - gameserver.ws.endpoints.metaverse - INFO - Received  message from {}
2025-05-27 09:45:52,069 - gameserver.ws.endpoints.metaverse - WARNING - Unhandled message type: 
2025-05-27 09:46:10,007 - gameserver.ws.endpoints.metaverse - INFO - Received  message from {}
2025-05-27 09:46:10,012 - gameserver.ws.endpoints.metaverse - WARNING - Unhandled message type: 
2025-05-27 09:46:21,771 - gameserver.ws.endpoints.metaverse - INFO - Received  message from {}
2025-05-27 09:46:21,776 - gameserver.ws.endpoints.metaverse - WARNING - Unhandled message type: 
2025-05-27 09:46:23,185 - gameserver.ws.endpoints.metaverse - INFO - Received  message from {}
2025-05-27 09:46:23,189 - gameserver.ws.endpoints.metaverse - WARNING - Unhandled message type: 
2025-05-27 09:46:25,301 - gameserver.ws.endpoints.metaverse - INFO - Received  message from {}
2025-05-27 09:46:25,305 - gameserver.ws.endpoints.metaverse - WARNING - Unhandled message type: 
2025-05-27 09:46:40,008 - gameserver.ws.endpoints.metaverse - INFO - Received  message from {}
2025-05-27 09:46:40,015 - gameserver.ws.endpoints.metaverse - WARNING - Unhandled message type: 
2025-05-27 09:47:10,008 - gameserver.ws.endpoints.metaverse - INFO - Received  message from {}
2025-05-27 09:47:10,011 - gameserver.ws.endpoints.metaverse - WARNING - Unhandled message type: 
2025-05-27 09:47:40,012 - gameserver.ws.endpoints.metaverse - INFO - Received  message from {}
2025-05-27 09:47:40,021 - gameserver.ws.endpoints.metaverse - WARNING - Unhandled message type: 
2025-05-27 09:47:52,693 - gameserver.ws.endpoints.metaverse - INFO - WebSocket disconnected for env (env: 1, agent: None, human: None)
2025-05-27 09:47:52,697 - gameserver.ws.endpoints.component.metaverse_connection_manager - INFO - Disconnected env_id 1
2025-05-27 09:47:52,699 - uvicorn.error - INFO - connection closed
2025-05-27 09:47:53,526 - uvicorn.error - INFO - ('127.0.0.1', 52242) - "WebSocket /ws/metaverse/env/1" [accepted]
2025-05-27 09:47:53,526 - gameserver.ws.endpoints.component.metaverse_connection_manager - INFO - New connection established for ID 1
2025-05-27 09:47:53,527 - uvicorn.error - INFO - connection open
2025-05-27 09:47:55,727 - gameserver.ws.endpoints.metaverse - INFO - Received status message from {}
2025-05-27 09:47:55,731 - uvicorn.error - ERROR - Exception in ASGI application
Traceback (most recent call last):
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/uvicorn/protocols/websockets/websockets_impl.py", line 243, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/routing.py", line 93, in app
    await func(session)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "/Users/own/Workspace/GameServer/gameserver/ws/endpoints/metaverse.py", line 139, in env_websocket
    await metaverse_websocket_handler(websocket, ws_type=ws_type, env_id=env_id)
  File "/Users/own/Workspace/GameServer/gameserver/ws/endpoints/metaverse.py", line 235, in metaverse_websocket_handler
    await handler(websocket, message)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^
TypeError: handle_status() missing 1 required positional argument: 'ws_type'
2025-05-27 09:47:55,934 - uvicorn.error - INFO - connection closed
2025-05-27 09:52:39,573 - uvicorn.error - INFO - Shutting down
2025-05-27 09:52:39,681 - uvicorn.error - INFO - Waiting for application shutdown.
2025-05-27 09:52:39,683 - uvicorn.error - INFO - Application shutdown complete.
2025-05-27 09:52:39,685 - uvicorn.error - INFO - Finished server process [9827]
2025-05-27 09:52:42,769 - agent_api - INFO - Logging to file: /Users/own/Workspace/GameServer/gameserver/storage/logs/agent_api_20250527.log
2025-05-27 09:52:42,769 - agent_api - INFO - Storage path: /Users/own/Workspace/GameServer/gameserver/storage
2025-05-27 09:52:42,770 - agent_api - INFO - Memory space: /Users/own/Workspace/GameServer/gameserver/storage/memory
2025-05-27 09:52:42,770 - agent_api - INFO - Role path: /Users/own/Workspace/GameServer/gameserver/storage/configs/roles
2025-05-27 09:52:42,774 - rotk_api - INFO - Logging to file: /Users/own/Workspace/GameServer/gameserver/storage/logs/rotk_api_20250527.log
2025-05-27 09:52:42,774 - rotk_api - INFO - Storage path: /Users/own/Workspace/GameServer/gameserver/storage
2025-05-27 09:52:42,775 - rotk_api - INFO - Memory space: /Users/own/Workspace/GameServer/gameserver/storage/memory
2025-05-27 09:52:42,775 - rotk_api - INFO - Role path: /Users/own/Workspace/GameServer/gameserver/storage/configs/roles
2025-05-27 09:52:46,843 - uvicorn.error - INFO - Started server process [13898]
2025-05-27 09:52:46,844 - uvicorn.error - INFO - Waiting for application startup.
2025-05-27 09:52:46,845 - uvicorn.error - INFO - Application startup complete.
2025-05-27 09:52:46,847 - uvicorn.error - INFO - Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2025-05-27 09:52:47,036 - uvicorn.error - INFO - ('127.0.0.1', 52424) - "WebSocket /ws/metaverse/env/1" [accepted]
2025-05-27 09:52:47,036 - gameserver.ws.endpoints.component.metaverse_connection_manager - INFO - New connection established for ID 1
2025-05-27 09:52:47,037 - uvicorn.error - INFO - connection open
2025-05-27 09:52:51,737 - gameserver.ws.endpoints.metaverse - INFO - Received env_message message from {}
2025-05-27 09:52:51,740 - gameserver.ws.endpoints.metaverse - WARNING - Unhandled message type: env_message
2025-05-27 09:52:53,289 - gameserver.ws.endpoints.metaverse - INFO - Received status message from {}
2025-05-27 09:52:53,291 - uvicorn.error - ERROR - Exception in ASGI application
Traceback (most recent call last):
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/uvicorn/protocols/websockets/websockets_impl.py", line 243, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/routing.py", line 93, in app
    await func(session)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "/Users/own/Workspace/GameServer/gameserver/ws/endpoints/metaverse.py", line 139, in env_websocket
    await metaverse_websocket_handler(websocket, ws_type=ws_type, env_id=env_id)
  File "/Users/own/Workspace/GameServer/gameserver/ws/endpoints/metaverse.py", line 235, in metaverse_websocket_handler
    await handler(websocket, message)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^
TypeError: handle_status() missing 1 required positional argument: 'ws_type'
2025-05-27 09:52:53,486 - uvicorn.error - INFO - connection closed
2025-05-27 09:55:39,334 - uvicorn.error - INFO - Shutting down
2025-05-27 09:55:39,443 - uvicorn.error - INFO - Waiting for application shutdown.
2025-05-27 09:55:39,446 - uvicorn.error - INFO - Application shutdown complete.
2025-05-27 09:55:39,448 - uvicorn.error - INFO - Finished server process [13898]
2025-05-27 09:55:42,326 - agent_api - INFO - Logging to file: /Users/own/Workspace/GameServer/gameserver/storage/logs/agent_api_20250527.log
2025-05-27 09:55:42,327 - agent_api - INFO - Storage path: /Users/own/Workspace/GameServer/gameserver/storage
2025-05-27 09:55:42,327 - agent_api - INFO - Memory space: /Users/own/Workspace/GameServer/gameserver/storage/memory
2025-05-27 09:55:42,327 - agent_api - INFO - Role path: /Users/own/Workspace/GameServer/gameserver/storage/configs/roles
2025-05-27 09:55:42,331 - rotk_api - INFO - Logging to file: /Users/own/Workspace/GameServer/gameserver/storage/logs/rotk_api_20250527.log
2025-05-27 09:55:42,331 - rotk_api - INFO - Storage path: /Users/own/Workspace/GameServer/gameserver/storage
2025-05-27 09:55:42,331 - rotk_api - INFO - Memory space: /Users/own/Workspace/GameServer/gameserver/storage/memory
2025-05-27 09:55:42,332 - rotk_api - INFO - Role path: /Users/own/Workspace/GameServer/gameserver/storage/configs/roles
2025-05-27 09:55:46,400 - uvicorn.error - INFO - Started server process [15347]
2025-05-27 09:55:46,401 - uvicorn.error - INFO - Waiting for application startup.
2025-05-27 09:55:46,402 - uvicorn.error - INFO - Application startup complete.
2025-05-27 09:55:46,404 - uvicorn.error - INFO - Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2025-05-27 09:55:47,160 - uvicorn.error - INFO - ('127.0.0.1', 52764) - "WebSocket /ws/metaverse/env/1" [accepted]
2025-05-27 09:55:47,161 - gameserver.ws.endpoints.component.metaverse_connection_manager - INFO - New connection established for ID 1
2025-05-27 09:55:47,162 - uvicorn.error - INFO - connection open
2025-05-27 09:55:48,796 - gameserver.ws.endpoints.metaverse - INFO - Received status message from {}
2025-05-27 09:55:48,799 - gameserver.ws.endpoints.component.metaverse_connection_manager - INFO - 连接状态: 1个 env, 0个 agents, 0个 humans
2025-05-27 09:55:54,033 - gameserver.ws.endpoints.metaverse - INFO - Received status message from {}
2025-05-27 09:55:54,037 - gameserver.ws.endpoints.component.metaverse_connection_manager - INFO - 连接状态: 1个 env, 0个 agents, 0个 humans
2025-05-27 09:56:10,923 - uvicorn.error - INFO - ('127.0.0.1', 52770) - "WebSocket /ws/metaverse/agent/1/1" [accepted]
2025-05-27 09:56:10,924 - gameserver.ws.endpoints.component.metaverse_connection_manager - INFO - New connection established for ID 1
2025-05-27 09:56:10,925 - uvicorn.error - INFO - connection open
2025-05-27 09:56:16,295 - gameserver.ws.endpoints.metaverse - INFO - Received status message from {}
2025-05-27 09:56:16,299 - gameserver.ws.endpoints.component.metaverse_connection_manager - INFO - 连接状态: 1个 env, 1个 agents, 0个 humans
2025-05-27 09:56:17,169 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 09:56:17,172 - uvicorn.error - ERROR - Exception in ASGI application
Traceback (most recent call last):
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/uvicorn/protocols/websockets/websockets_impl.py", line 243, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/routing.py", line 93, in app
    await func(session)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "/Users/own/Workspace/GameServer/gameserver/ws/endpoints/metaverse.py", line 137, in env_websocket
    await metaverse_websocket_handler(websocket, ws_type=ws_type, env_id=env_id)
  File "/Users/own/Workspace/GameServer/gameserver/ws/endpoints/metaverse.py", line 233, in metaverse_websocket_handler
    await handler(websocket, message)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^
TypeError: handle_ping() missing 1 required positional argument: 'ws_type'
2025-05-27 09:56:17,376 - uvicorn.error - INFO - connection closed
2025-05-27 09:56:40,931 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 09:56:40,938 - uvicorn.error - ERROR - Exception in ASGI application
Traceback (most recent call last):
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/uvicorn/protocols/websockets/websockets_impl.py", line 243, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/routing.py", line 93, in app
    await func(session)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "/Users/own/Workspace/GameServer/gameserver/ws/endpoints/metaverse.py", line 151, in agent_websocket
    await metaverse_websocket_handler(
        websocket, ws_type=ws_type, env_id=env_id, agent_id=play_id
    )
  File "/Users/own/Workspace/GameServer/gameserver/ws/endpoints/metaverse.py", line 233, in metaverse_websocket_handler
    await handler(websocket, message)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^
TypeError: handle_ping() missing 1 required positional argument: 'ws_type'
2025-05-27 09:56:41,135 - uvicorn.error - INFO - connection closed
2025-05-27 09:56:47,707 - uvicorn.error - INFO - Shutting down
2025-05-27 09:56:47,815 - uvicorn.error - INFO - Waiting for application shutdown.
2025-05-27 09:56:47,816 - uvicorn.error - INFO - Application shutdown complete.
2025-05-27 09:56:47,817 - uvicorn.error - INFO - Finished server process [15347]
2025-05-27 14:59:51,563 - agent_api - INFO - Logging to file: /Users/own/Workspace/GameServer/gameserver/storage/logs/agent_api_20250527.log
2025-05-27 14:59:51,563 - agent_api - INFO - Storage path: /Users/own/Workspace/GameServer/gameserver/storage
2025-05-27 14:59:51,564 - agent_api - INFO - Memory space: /Users/own/Workspace/GameServer/gameserver/storage/memory
2025-05-27 14:59:51,564 - agent_api - INFO - Role path: /Users/own/Workspace/GameServer/gameserver/storage/configs/roles
2025-05-27 14:59:51,567 - rotk_api - INFO - Logging to file: /Users/own/Workspace/GameServer/gameserver/storage/logs/rotk_api_20250527.log
2025-05-27 14:59:51,568 - rotk_api - INFO - Storage path: /Users/own/Workspace/GameServer/gameserver/storage
2025-05-27 14:59:51,568 - rotk_api - INFO - Memory space: /Users/own/Workspace/GameServer/gameserver/storage/memory
2025-05-27 14:59:51,568 - rotk_api - INFO - Role path: /Users/own/Workspace/GameServer/gameserver/storage/configs/roles
2025-05-27 14:59:55,641 - uvicorn.error - INFO - Started server process [37302]
2025-05-27 14:59:55,642 - uvicorn.error - INFO - Waiting for application startup.
2025-05-27 14:59:55,643 - uvicorn.error - INFO - Application startup complete.
2025-05-27 14:59:55,646 - uvicorn.error - INFO - Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2025-05-27 14:59:56,853 - uvicorn.error - INFO - ('127.0.0.1', 61617) - "WebSocket /ws/metaverse/env/1" [accepted]
2025-05-27 14:59:56,853 - gameserver.ws.endpoints.component.metaverse_connection_manager - INFO - New connection established for ID 1
2025-05-27 14:59:56,855 - uvicorn.error - INFO - connection open
2025-05-27 14:59:58,741 - uvicorn.error - INFO - ('127.0.0.1', 61621) - "WebSocket /ws/metaverse/agent/1/1" [accepted]
2025-05-27 14:59:58,742 - gameserver.ws.endpoints.component.metaverse_connection_manager - INFO - New connection established for ID 1
2025-05-27 14:59:58,743 - uvicorn.error - INFO - connection open
2025-05-27 15:00:01,937 - gameserver.ws.endpoints.metaverse - INFO - Received status message from {}
2025-05-27 15:00:01,940 - gameserver.ws.endpoints.component.metaverse_connection_manager - INFO - 连接状态: 1个 env, 1个 agents, 0个 humans
2025-05-27 15:00:06,582 - gameserver.ws.endpoints.metaverse - INFO - Received status message from {}
2025-05-27 15:00:06,584 - gameserver.ws.endpoints.component.metaverse_connection_manager - INFO - 连接状态: 1个 env, 1个 agents, 0个 humans
2025-05-27 15:00:26,861 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:00:26,866 - uvicorn.error - ERROR - Exception in ASGI application
Traceback (most recent call last):
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/uvicorn/protocols/websockets/websockets_impl.py", line 243, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/routing.py", line 93, in app
    await func(session)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "/Users/own/Workspace/GameServer/gameserver/ws/endpoints/metaverse.py", line 136, in env_websocket
    await metaverse_websocket_handler(websocket, ws_type=ws_type, env_id=env_id)
  File "/Users/own/Workspace/GameServer/gameserver/ws/endpoints/metaverse.py", line 232, in metaverse_websocket_handler
    await handler(websocket, message)
  File "/Users/own/Workspace/GameServer/gameserver/ws/endpoints/metaverse.py", line 84, in handle_ping
    user_type=ws_type,
              ^^^^^^^
NameError: name 'ws_type' is not defined
2025-05-27 15:00:27,071 - uvicorn.error - INFO - connection closed
2025-05-27 15:00:28,748 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:00:28,751 - uvicorn.error - ERROR - Exception in ASGI application
Traceback (most recent call last):
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/uvicorn/protocols/websockets/websockets_impl.py", line 243, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/routing.py", line 93, in app
    await func(session)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "/Users/own/Workspace/GameServer/gameserver/ws/endpoints/metaverse.py", line 150, in agent_websocket
    await metaverse_websocket_handler(
        websocket, ws_type=ws_type, env_id=env_id, agent_id=play_id
    )
  File "/Users/own/Workspace/GameServer/gameserver/ws/endpoints/metaverse.py", line 232, in metaverse_websocket_handler
    await handler(websocket, message)
  File "/Users/own/Workspace/GameServer/gameserver/ws/endpoints/metaverse.py", line 84, in handle_ping
    user_type=ws_type,
              ^^^^^^^
NameError: name 'ws_type' is not defined
2025-05-27 15:00:28,949 - uvicorn.error - INFO - connection closed
2025-05-27 15:02:12,117 - uvicorn.error - INFO - Shutting down
2025-05-27 15:02:12,221 - uvicorn.error - INFO - Waiting for application shutdown.
2025-05-27 15:02:12,224 - uvicorn.error - INFO - Application shutdown complete.
2025-05-27 15:02:12,225 - uvicorn.error - INFO - Finished server process [37302]
2025-05-27 15:02:15,226 - agent_api - INFO - Logging to file: /Users/own/Workspace/GameServer/gameserver/storage/logs/agent_api_20250527.log
2025-05-27 15:02:15,226 - agent_api - INFO - Storage path: /Users/own/Workspace/GameServer/gameserver/storage
2025-05-27 15:02:15,227 - agent_api - INFO - Memory space: /Users/own/Workspace/GameServer/gameserver/storage/memory
2025-05-27 15:02:15,227 - agent_api - INFO - Role path: /Users/own/Workspace/GameServer/gameserver/storage/configs/roles
2025-05-27 15:02:15,230 - rotk_api - INFO - Logging to file: /Users/own/Workspace/GameServer/gameserver/storage/logs/rotk_api_20250527.log
2025-05-27 15:02:15,231 - rotk_api - INFO - Storage path: /Users/own/Workspace/GameServer/gameserver/storage
2025-05-27 15:02:15,231 - rotk_api - INFO - Memory space: /Users/own/Workspace/GameServer/gameserver/storage/memory
2025-05-27 15:02:15,232 - rotk_api - INFO - Role path: /Users/own/Workspace/GameServer/gameserver/storage/configs/roles
2025-05-27 15:02:19,299 - uvicorn.error - INFO - Started server process [38478]
2025-05-27 15:02:19,300 - uvicorn.error - INFO - Waiting for application startup.
2025-05-27 15:02:19,301 - uvicorn.error - INFO - Application startup complete.
2025-05-27 15:02:19,303 - uvicorn.error - INFO - Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2025-05-27 15:02:23,809 - uvicorn.error - INFO - ('127.0.0.1', 61739) - "WebSocket /ws/metaverse/env/1" [accepted]
2025-05-27 15:02:23,810 - gameserver.ws.endpoints.component.metaverse_connection_manager - INFO - New connection established for ID 1
2025-05-27 15:02:23,811 - uvicorn.error - INFO - connection open
2025-05-27 15:02:25,909 - gameserver.ws.endpoints.metaverse - INFO - Received status message from {}
2025-05-27 15:02:25,913 - gameserver.ws.endpoints.component.metaverse_connection_manager - INFO - 连接状态: 1个 env, 0个 agents, 0个 humans
2025-05-27 15:02:30,375 - uvicorn.error - INFO - ('127.0.0.1', 61743) - "WebSocket /ws/metaverse/agent/1/1" [accepted]
2025-05-27 15:02:30,377 - gameserver.ws.endpoints.component.metaverse_connection_manager - INFO - New connection established for ID 1
2025-05-27 15:02:30,378 - uvicorn.error - INFO - connection open
2025-05-27 15:02:31,729 - gameserver.ws.endpoints.metaverse - INFO - Received status message from {}
2025-05-27 15:02:31,732 - gameserver.ws.endpoints.component.metaverse_connection_manager - INFO - 连接状态: 1个 env, 1个 agents, 0个 humans
2025-05-27 15:02:53,816 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:02:53,822 - uvicorn.error - ERROR - Exception in ASGI application
Traceback (most recent call last):
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/uvicorn/protocols/websockets/websockets_impl.py", line 243, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/routing.py", line 93, in app
    await func(session)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "/Users/own/Workspace/GameServer/gameserver/ws/endpoints/metaverse.py", line 136, in env_websocket
    await metaverse_websocket_handler(websocket, ws_type=ws_type, env_id=env_id)
  File "/Users/own/Workspace/GameServer/gameserver/ws/endpoints/metaverse.py", line 232, in metaverse_websocket_handler
    await handler(websocket, message)
  File "/Users/own/Workspace/GameServer/gameserver/ws/endpoints/metaverse.py", line 75, in handle_ping
    json.dumps(
    ~~~~~~~~~~^
        {
        ^
    ...<11 lines>...
        }
        ^
    )
    ^
  File "/Users/own/.local/share/uv/python/cpython-3.13.2-macos-aarch64-none/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/Users/own/.local/share/uv/python/cpython-3.13.2-macos-aarch64-none/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/Users/own/.local/share/uv/python/cpython-3.13.2-macos-aarch64-none/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/Users/own/.local/share/uv/python/cpython-3.13.2-macos-aarch64-none/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type WSIDInfo is not JSON serializable
2025-05-27 15:02:54,043 - uvicorn.error - INFO - connection closed
2025-05-27 15:03:00,384 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:03:00,388 - uvicorn.error - ERROR - Exception in ASGI application
Traceback (most recent call last):
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/uvicorn/protocols/websockets/websockets_impl.py", line 243, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/routing.py", line 93, in app
    await func(session)
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "/Users/own/Workspace/GameServer/gameserver/ws/endpoints/metaverse.py", line 150, in agent_websocket
    await metaverse_websocket_handler(
        websocket, ws_type=ws_type, env_id=env_id, agent_id=play_id
    )
  File "/Users/own/Workspace/GameServer/gameserver/ws/endpoints/metaverse.py", line 232, in metaverse_websocket_handler
    await handler(websocket, message)
  File "/Users/own/Workspace/GameServer/gameserver/ws/endpoints/metaverse.py", line 75, in handle_ping
    json.dumps(
    ~~~~~~~~~~^
        {
        ^
    ...<11 lines>...
        }
        ^
    )
    ^
  File "/Users/own/.local/share/uv/python/cpython-3.13.2-macos-aarch64-none/lib/python3.13/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/Users/own/.local/share/uv/python/cpython-3.13.2-macos-aarch64-none/lib/python3.13/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/Users/own/.local/share/uv/python/cpython-3.13.2-macos-aarch64-none/lib/python3.13/json/encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "/Users/own/.local/share/uv/python/cpython-3.13.2-macos-aarch64-none/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type WSIDInfo is not JSON serializable
2025-05-27 15:03:00,592 - uvicorn.error - INFO - connection closed
2025-05-27 15:27:37,374 - uvicorn.error - INFO - Shutting down
2025-05-27 15:27:37,482 - uvicorn.error - INFO - Waiting for application shutdown.
2025-05-27 15:27:37,484 - uvicorn.error - INFO - Application shutdown complete.
2025-05-27 15:27:37,486 - uvicorn.error - INFO - Finished server process [38478]
2025-05-27 15:27:40,452 - agent_api - INFO - Logging to file: /Users/own/Workspace/GameServer/gameserver/storage/logs/agent_api_20250527.log
2025-05-27 15:27:40,453 - agent_api - INFO - Storage path: /Users/own/Workspace/GameServer/gameserver/storage
2025-05-27 15:27:40,453 - agent_api - INFO - Memory space: /Users/own/Workspace/GameServer/gameserver/storage/memory
2025-05-27 15:27:40,454 - agent_api - INFO - Role path: /Users/own/Workspace/GameServer/gameserver/storage/configs/roles
2025-05-27 15:27:40,457 - rotk_api - INFO - Logging to file: /Users/own/Workspace/GameServer/gameserver/storage/logs/rotk_api_20250527.log
2025-05-27 15:27:40,457 - rotk_api - INFO - Storage path: /Users/own/Workspace/GameServer/gameserver/storage
2025-05-27 15:27:40,458 - rotk_api - INFO - Memory space: /Users/own/Workspace/GameServer/gameserver/storage/memory
2025-05-27 15:27:40,458 - rotk_api - INFO - Role path: /Users/own/Workspace/GameServer/gameserver/storage/configs/roles
2025-05-27 15:27:44,527 - uvicorn.error - INFO - Started server process [50691]
2025-05-27 15:27:44,529 - uvicorn.error - INFO - Waiting for application startup.
2025-05-27 15:27:44,530 - uvicorn.error - INFO - Application startup complete.
2025-05-27 15:27:44,532 - uvicorn.error - INFO - Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2025-05-27 15:27:45,049 - uvicorn.error - INFO - ('127.0.0.1', 64047) - "WebSocket /ws/metaverse/env/1" [accepted]
2025-05-27 15:27:45,049 - gameserver.ws.endpoints.component.metaverse_connection_manager - INFO - New connection established for ID 1
2025-05-27 15:27:45,050 - uvicorn.error - INFO - connection open
2025-05-27 15:27:50,459 - gameserver.ws.endpoints.metaverse - INFO - Received ping message from {}
2025-05-27 15:27:50,462 - gameserver.ws.endpoints.metaverse - WARNING - Unhandled message type: ping
2025-05-27 15:27:53,198 - gameserver.ws.endpoints.metaverse - INFO - Received ping message from {}
2025-05-27 15:27:53,201 - gameserver.ws.endpoints.metaverse - WARNING - Unhandled message type: ping
2025-05-27 15:28:10,334 - gameserver.ws.endpoints.metaverse - INFO - Received env_message message from {}
2025-05-27 15:28:10,337 - gameserver.ws.endpoints.metaverse - WARNING - Unhandled message type: env_message
2025-05-27 15:28:15,057 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:28:19,840 - gameserver.ws.endpoints.metaverse - INFO - Received env_message message from {}
2025-05-27 15:28:19,845 - gameserver.ws.endpoints.metaverse - WARNING - Unhandled message type: env_message
2025-05-27 15:28:29,710 - gameserver.ws.endpoints.metaverse - INFO - Received env_message message from {}
2025-05-27 15:28:29,713 - gameserver.ws.endpoints.metaverse - WARNING - Unhandled message type: env_message
2025-05-27 15:28:45,058 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:29:15,059 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:29:45,060 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:30:15,062 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:30:45,062 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:31:15,063 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:31:45,065 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:32:15,067 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:32:45,068 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:33:15,069 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:33:45,070 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:34:15,071 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:34:45,073 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:35:15,075 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:35:45,076 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:36:15,078 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:36:45,079 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:37:15,081 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:37:45,081 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:38:15,083 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:38:45,085 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:39:15,087 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:39:45,089 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:40:15,089 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:40:45,091 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:41:15,093 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:41:45,096 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:42:15,098 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:42:45,099 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:43:15,099 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:43:45,101 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:44:06,535 - uvicorn.error - INFO - ('127.0.0.1', 64933) - "WebSocket /ws/metaverse/agent/1/1" [accepted]
2025-05-27 15:44:06,536 - gameserver.ws.endpoints.component.metaverse_connection_manager - INFO - New connection established for ID 1
2025-05-27 15:44:06,538 - uvicorn.error - INFO - connection open
2025-05-27 15:44:14,248 - gameserver.ws.endpoints.metaverse - INFO - Received ping message from {}
2025-05-27 15:44:14,251 - gameserver.ws.endpoints.metaverse - WARNING - Unhandled message type: ping
2025-05-27 15:44:15,103 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:44:25,773 - gameserver.ws.endpoints.metaverse - INFO - Received ping message from {}
2025-05-27 15:44:25,780 - gameserver.ws.endpoints.metaverse - WARNING - Unhandled message type: ping
2025-05-27 15:44:32,381 - gameserver.ws.endpoints.metaverse - INFO - Received ping message from {}
2025-05-27 15:44:32,385 - gameserver.ws.endpoints.metaverse - WARNING - Unhandled message type: ping
2025-05-27 15:44:36,548 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:44:45,104 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:45:06,552 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:45:15,105 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:45:36,552 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:45:45,106 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:46:06,553 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:46:15,107 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:46:36,554 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:46:45,114 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:47:06,557 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:47:15,110 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from {}
2025-05-27 15:47:29,904 - gameserver.ws.endpoints.metaverse - INFO - WebSocket disconnected for agent (env: 1, agent: 1, human: None)
2025-05-27 15:47:29,912 - gameserver.ws.endpoints.component.metaverse_connection_manager - INFO - Disconnected client 1 from 1
2025-05-27 15:47:29,916 - uvicorn.error - INFO - connection closed
2025-05-27 15:47:32,579 - gameserver.ws.endpoints.metaverse - INFO - WebSocket disconnected for env (env: 1, agent: None, human: None)
2025-05-27 15:47:32,583 - gameserver.ws.endpoints.component.metaverse_connection_manager - INFO - Disconnected env_id 1
2025-05-27 15:47:32,585 - uvicorn.error - INFO - connection closed
2025-05-27 15:47:35,708 - uvicorn.error - INFO - Shutting down
2025-05-27 15:47:35,811 - uvicorn.error - INFO - Waiting for application shutdown.
2025-05-27 15:47:35,813 - uvicorn.error - INFO - Application shutdown complete.
2025-05-27 15:47:35,814 - uvicorn.error - INFO - Finished server process [50691]
2025-05-27 15:47:38,808 - agent_api - INFO - Logging to file: /Users/own/Workspace/GameServer/gameserver/storage/logs/agent_api_20250527.log
2025-05-27 15:47:38,808 - agent_api - INFO - Storage path: /Users/own/Workspace/GameServer/gameserver/storage
2025-05-27 15:47:38,809 - agent_api - INFO - Memory space: /Users/own/Workspace/GameServer/gameserver/storage/memory
2025-05-27 15:47:38,809 - agent_api - INFO - Role path: /Users/own/Workspace/GameServer/gameserver/storage/configs/roles
2025-05-27 15:47:38,812 - rotk_api - INFO - Logging to file: /Users/own/Workspace/GameServer/gameserver/storage/logs/rotk_api_20250527.log
2025-05-27 15:47:38,813 - rotk_api - INFO - Storage path: /Users/own/Workspace/GameServer/gameserver/storage
2025-05-27 15:47:38,813 - rotk_api - INFO - Memory space: /Users/own/Workspace/GameServer/gameserver/storage/memory
2025-05-27 15:47:38,813 - rotk_api - INFO - Role path: /Users/own/Workspace/GameServer/gameserver/storage/configs/roles
2025-05-27 15:47:42,877 - uvicorn.error - INFO - Started server process [60307]
2025-05-27 15:47:42,879 - uvicorn.error - INFO - Waiting for application startup.
2025-05-27 15:47:42,880 - uvicorn.error - INFO - Application startup complete.
2025-05-27 15:47:42,882 - uvicorn.error - INFO - Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2025-05-27 15:47:48,961 - uvicorn.error - INFO - ('127.0.0.1', 65183) - "WebSocket /ws/metaverse/env/1" [accepted]
2025-05-27 15:47:48,962 - gameserver.ws.endpoints.component.metaverse_connection_manager - INFO - New connection established for ID 1
2025-05-27 15:47:48,963 - uvicorn.error - INFO - connection open
2025-05-27 15:47:53,240 - gameserver.ws.endpoints.metaverse - INFO - Received ping message from env
2025-05-27 15:47:53,244 - gameserver.ws.endpoints.metaverse - WARNING - Unhandled message type: ping
2025-05-27 15:48:08,846 - gameserver.ws.endpoints.metaverse - INFO - Received env_message message from env
2025-05-27 15:48:08,850 - gameserver.ws.endpoints.metaverse - WARNING - Unhandled message type: env_message
2025-05-27 15:48:18,968 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from env
2025-05-27 15:48:48,968 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from env
2025-05-27 15:49:18,970 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from env
2025-05-27 15:49:48,972 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from env
2025-05-27 15:50:18,973 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from env
2025-05-27 15:50:19,424 - gameserver.ws.endpoints.metaverse - INFO - Received ping message from env
2025-05-27 15:50:19,432 - gameserver.ws.endpoints.metaverse - WARNING - Unhandled message type: ping
2025-05-27 15:50:28,348 - gameserver.ws.endpoints.metaverse - INFO - WebSocket disconnected for env (env: 1, agent: None, human: None)
2025-05-27 15:50:28,351 - gameserver.ws.endpoints.component.metaverse_connection_manager - INFO - Disconnected env_id 1
2025-05-27 15:50:28,353 - uvicorn.error - INFO - connection closed
2025-05-27 15:50:29,125 - uvicorn.error - INFO - ('127.0.0.1', 65341) - "WebSocket /ws/metaverse/env/1" [accepted]
2025-05-27 15:50:29,125 - gameserver.ws.endpoints.component.metaverse_connection_manager - INFO - New connection established for ID 1
2025-05-27 15:50:29,126 - uvicorn.error - INFO - connection open
2025-05-27 15:50:35,719 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from env
2025-05-27 15:50:59,131 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from env
2025-05-27 15:51:29,134 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from env
2025-05-27 15:51:59,134 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from env
2025-05-27 15:52:29,136 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from env
2025-05-27 15:52:59,139 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from env
2025-05-27 15:53:29,139 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from env
2025-05-27 15:53:54,818 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from env
2025-05-27 15:53:55,847 - gameserver.ws.endpoints.metaverse - INFO - WebSocket disconnected for env (env: 1, agent: None, human: None)
2025-05-27 15:53:55,851 - gameserver.ws.endpoints.component.metaverse_connection_manager - INFO - Disconnected env_id 1
2025-05-27 15:53:55,853 - uvicorn.error - INFO - connection closed
2025-05-27 15:53:56,608 - uvicorn.error - INFO - ('127.0.0.1', 49654) - "WebSocket /ws/metaverse/env/1" [accepted]
2025-05-27 15:53:56,609 - gameserver.ws.endpoints.component.metaverse_connection_manager - INFO - New connection established for ID 1
2025-05-27 15:53:56,610 - uvicorn.error - INFO - connection open
2025-05-27 15:54:17,335 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from env
2025-05-27 15:54:20,283 - gameserver.ws.endpoints.metaverse - INFO - Received status message from env
2025-05-27 15:54:20,287 - gameserver.ws.endpoints.component.metaverse_connection_manager - INFO - 连接状态: 1个 env, 0个 agents, 0个 humans
2025-05-27 15:54:26,615 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from env
2025-05-27 15:54:56,616 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from env
2025-05-27 15:55:26,619 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from env
2025-05-27 15:55:56,618 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from env
2025-05-27 15:56:26,620 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from env
2025-05-27 15:56:56,622 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from env
2025-05-27 15:57:26,624 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from env
2025-05-27 15:57:56,624 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from env
2025-05-27 15:58:26,626 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from env
2025-05-27 15:58:56,628 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from env
2025-05-27 15:59:26,630 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from env
2025-05-27 15:59:56,633 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from env
2025-05-27 16:00:26,632 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from env
2025-05-27 16:00:56,634 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from env
2025-05-27 16:01:26,636 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from env
2025-05-27 16:01:56,637 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from env
2025-05-27 16:02:26,639 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from env
2025-05-27 16:02:56,640 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from env
2025-05-27 16:03:26,641 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from env
2025-05-27 16:03:56,643 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from env
2025-05-27 16:04:17,720 - uvicorn.error - INFO - Shutting down
2025-05-27 16:04:17,726 - gameserver.ws.endpoints.metaverse - INFO - WebSocket disconnected for env (env: 1, agent: None, human: None)
2025-05-27 16:04:17,728 - gameserver.ws.endpoints.component.metaverse_connection_manager - INFO - Disconnected env_id 1
2025-05-27 16:04:17,731 - uvicorn.error - INFO - connection closed
2025-05-27 16:04:17,825 - uvicorn.error - INFO - Finished server process [60307]
2025-05-27 16:04:17,835 - uvicorn.error - ERROR - Traceback (most recent call last):
  File "/Users/own/.local/share/uv/python/cpython-3.13.2-macos-aarch64-none/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/Users/own/.local/share/uv/python/cpython-3.13.2-macos-aarch64-none/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "uvloop/loop.pyx", line 1512, in uvloop.loop.Loop.run_until_complete
  File "uvloop/loop.pyx", line 1505, in uvloop.loop.Loop.run_until_complete
  File "uvloop/loop.pyx", line 1379, in uvloop.loop.Loop.run_forever
  File "uvloop/loop.pyx", line 557, in uvloop.loop.Loop._run
  File "uvloop/loop.pyx", line 476, in uvloop.loop.Loop._on_idle
  File "uvloop/cbhandles.pyx", line 83, in uvloop.loop.Handle._run
  File "uvloop/cbhandles.pyx", line 63, in uvloop.loop.Handle._run
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 69, in serve
    with self.capture_signals():
         ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/own/.local/share/uv/python/cpython-3.13.2-macos-aarch64-none/lib/python3.13/contextlib.py", line 148, in __exit__
    next(self.gen)
    ~~~~^^^^^^^^^^
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 330, in capture_signals
    signal.raise_signal(captured_signal)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/own/.local/share/uv/python/cpython-3.13.2-macos-aarch64-none/lib/python3.13/asyncio/runners.py", line 157, in _on_sigint
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/starlette/routing.py", line 699, in lifespan
    await receive()
  File "/Users/own/Workspace/GameServer/.venv/lib/python3.13/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/own/.local/share/uv/python/cpython-3.13.2-macos-aarch64-none/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

2025-05-27 16:04:21,052 - agent_api - INFO - Logging to file: /Users/own/Workspace/GameServer/gameserver/storage/logs/agent_api_20250527.log
2025-05-27 16:04:21,053 - agent_api - INFO - Storage path: /Users/own/Workspace/GameServer/gameserver/storage
2025-05-27 16:04:21,054 - agent_api - INFO - Memory space: /Users/own/Workspace/GameServer/gameserver/storage/memory
2025-05-27 16:04:21,054 - agent_api - INFO - Role path: /Users/own/Workspace/GameServer/gameserver/storage/configs/roles
2025-05-27 16:04:21,057 - rotk_api - INFO - Logging to file: /Users/own/Workspace/GameServer/gameserver/storage/logs/rotk_api_20250527.log
2025-05-27 16:04:21,057 - rotk_api - INFO - Storage path: /Users/own/Workspace/GameServer/gameserver/storage
2025-05-27 16:04:21,058 - rotk_api - INFO - Memory space: /Users/own/Workspace/GameServer/gameserver/storage/memory
2025-05-27 16:04:21,058 - rotk_api - INFO - Role path: /Users/own/Workspace/GameServer/gameserver/storage/configs/roles
2025-05-27 16:04:25,107 - uvicorn.error - INFO - Started server process [68595]
2025-05-27 16:04:25,108 - uvicorn.error - INFO - Waiting for application startup.
2025-05-27 16:04:25,109 - uvicorn.error - INFO - Application startup complete.
2025-05-27 16:04:25,110 - uvicorn.error - INFO - Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2025-05-27 16:04:26,546 - uvicorn.error - INFO - ('127.0.0.1', 50104) - "WebSocket /ws/metaverse/env/1" 403
2025-05-27 16:04:26,546 - uvicorn.error - INFO - connection rejected (403 Forbidden)
2025-05-27 16:04:26,547 - uvicorn.error - INFO - connection closed
2025-05-27 16:04:27,595 - uvicorn.error - INFO - ('127.0.0.1', 50106) - "WebSocket /ws/metaverse/env/1" 403
2025-05-27 16:04:27,596 - uvicorn.error - INFO - connection rejected (403 Forbidden)
2025-05-27 16:04:27,597 - uvicorn.error - INFO - connection closed
2025-05-27 16:04:28,598 - uvicorn.error - INFO - ('127.0.0.1', 50110) - "WebSocket /ws/metaverse/env/1" 403
2025-05-27 16:04:28,598 - uvicorn.error - INFO - connection rejected (403 Forbidden)
2025-05-27 16:04:28,599 - uvicorn.error - INFO - connection closed
2025-05-27 16:04:33,443 - uvicorn.error - INFO - ('127.0.0.1', 50114) - "WebSocket /ws/metaverse/env/1" 403
2025-05-27 16:04:33,444 - uvicorn.error - INFO - connection rejected (403 Forbidden)
2025-05-27 16:04:33,445 - uvicorn.error - INFO - connection closed
2025-05-27 16:04:37,574 - uvicorn.error - INFO - ('127.0.0.1', 50118) - "WebSocket /ws/metaverse/agent/1/1" 403
2025-05-27 16:04:37,575 - uvicorn.error - INFO - connection rejected (403 Forbidden)
2025-05-27 16:04:37,575 - uvicorn.error - INFO - connection closed
2025-05-27 16:04:46,304 - uvicorn.error - INFO - ('127.0.0.1', 50132) - "WebSocket /ws/metaverse/env/1" 403
2025-05-27 16:04:46,305 - uvicorn.error - INFO - connection rejected (403 Forbidden)
2025-05-27 16:04:46,306 - uvicorn.error - INFO - connection closed
2025-05-27 18:15:28,175 - uvicorn.error - INFO - ('127.0.0.1', 63280) - "WebSocket /ws/metaverse/env/1" 403
2025-05-27 18:15:28,189 - uvicorn.error - INFO - connection rejected (403 Forbidden)
2025-05-27 18:15:28,190 - uvicorn.error - INFO - connection closed
2025-05-27 18:15:30,203 - uvicorn.error - INFO - ('127.0.0.1', 63282) - "WebSocket /ws/metaverse/env/1" 403
2025-05-27 18:15:30,204 - uvicorn.error - INFO - connection rejected (403 Forbidden)
2025-05-27 18:15:30,204 - uvicorn.error - INFO - connection closed
2025-05-27 18:16:18,026 - uvicorn.error - INFO - Shutting down
2025-05-27 18:16:18,132 - uvicorn.error - INFO - Waiting for application shutdown.
2025-05-27 18:16:18,136 - uvicorn.error - INFO - Application shutdown complete.
2025-05-27 18:16:18,137 - uvicorn.error - INFO - Finished server process [68595]
2025-05-27 18:16:21,101 - agent_api - INFO - Logging to file: /Users/own/Workspace/GameServer/gameserver/storage/logs/agent_api_20250527.log
2025-05-27 18:16:21,102 - agent_api - INFO - Storage path: /Users/own/Workspace/GameServer/gameserver/storage
2025-05-27 18:16:21,102 - agent_api - INFO - Memory space: /Users/own/Workspace/GameServer/gameserver/storage/memory
2025-05-27 18:16:21,102 - agent_api - INFO - Role path: /Users/own/Workspace/GameServer/gameserver/storage/configs/roles
2025-05-27 18:16:21,105 - rotk_api - INFO - Logging to file: /Users/own/Workspace/GameServer/gameserver/storage/logs/rotk_api_20250527.log
2025-05-27 18:16:21,106 - rotk_api - INFO - Storage path: /Users/own/Workspace/GameServer/gameserver/storage
2025-05-27 18:16:21,106 - rotk_api - INFO - Memory space: /Users/own/Workspace/GameServer/gameserver/storage/memory
2025-05-27 18:16:21,106 - rotk_api - INFO - Role path: /Users/own/Workspace/GameServer/gameserver/storage/configs/roles
2025-05-27 18:16:25,174 - uvicorn.error - INFO - Started server process [36079]
2025-05-27 18:16:25,175 - uvicorn.error - INFO - Waiting for application startup.
2025-05-27 18:16:25,176 - uvicorn.error - INFO - Application startup complete.
2025-05-27 18:16:25,179 - uvicorn.error - INFO - Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2025-05-27 18:16:25,472 - uvicorn.error - INFO - ('127.0.0.1', 63347) - "WebSocket /ws/metaverse/env/1" 403
2025-05-27 18:16:25,473 - uvicorn.error - INFO - connection rejected (403 Forbidden)
2025-05-27 18:16:25,474 - uvicorn.error - INFO - connection closed
2025-05-27 18:16:26,174 - uvicorn.error - INFO - ('127.0.0.1', 63349) - "WebSocket /ws/metaverse/env/1" 403
2025-05-27 18:16:26,175 - uvicorn.error - INFO - connection rejected (403 Forbidden)
2025-05-27 18:16:26,176 - uvicorn.error - INFO - connection closed
2025-05-27 18:16:26,698 - uvicorn.error - INFO - ('127.0.0.1', 63351) - "WebSocket /ws/metaverse/env/1" 403
2025-05-27 18:16:26,698 - uvicorn.error - INFO - connection rejected (403 Forbidden)
2025-05-27 18:16:26,699 - uvicorn.error - INFO - connection closed
2025-05-27 18:16:27,105 - uvicorn.error - INFO - ('127.0.0.1', 63353) - "WebSocket /ws/metaverse/env/1" 403
2025-05-27 18:16:27,106 - uvicorn.error - INFO - connection rejected (403 Forbidden)
2025-05-27 18:16:27,107 - uvicorn.error - INFO - connection closed
2025-05-27 18:18:37,993 - uvicorn.error - INFO - Shutting down
2025-05-27 18:18:38,101 - uvicorn.error - INFO - Waiting for application shutdown.
2025-05-27 18:18:38,102 - uvicorn.error - INFO - Application shutdown complete.
2025-05-27 18:18:38,103 - uvicorn.error - INFO - Finished server process [36079]
2025-05-27 18:18:40,791 - agent_api - INFO - Logging to file: /Users/own/Workspace/GameServer/gameserver/storage/logs/agent_api_20250527.log
2025-05-27 18:18:40,792 - agent_api - INFO - Storage path: /Users/own/Workspace/GameServer/gameserver/storage
2025-05-27 18:18:40,792 - agent_api - INFO - Memory space: /Users/own/Workspace/GameServer/gameserver/storage/memory
2025-05-27 18:18:40,792 - agent_api - INFO - Role path: /Users/own/Workspace/GameServer/gameserver/storage/configs/roles
2025-05-27 18:18:40,795 - rotk_api - INFO - Logging to file: /Users/own/Workspace/GameServer/gameserver/storage/logs/rotk_api_20250527.log
2025-05-27 18:18:40,796 - rotk_api - INFO - Storage path: /Users/own/Workspace/GameServer/gameserver/storage
2025-05-27 18:18:40,796 - rotk_api - INFO - Memory space: /Users/own/Workspace/GameServer/gameserver/storage/memory
2025-05-27 18:18:40,797 - rotk_api - INFO - Role path: /Users/own/Workspace/GameServer/gameserver/storage/configs/roles
2025-05-27 18:18:44,868 - uvicorn.error - INFO - Started server process [36784]
2025-05-27 18:18:44,870 - uvicorn.error - INFO - Waiting for application startup.
2025-05-27 18:18:44,871 - uvicorn.error - INFO - Application startup complete.
2025-05-27 18:18:44,873 - uvicorn.error - INFO - Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2025-05-27 18:18:45,026 - uvicorn.error - INFO - ('127.0.0.1', 63508) - "WebSocket /ws/metaverse/env/1" [accepted]
2025-05-27 18:18:45,027 - gameserver.ws.endpoints.component.metaverse_connection_manager - INFO - New connection established for ID 1
2025-05-27 18:18:45,028 - uvicorn.error - INFO - connection open
2025-05-27 18:18:54,522 - uvicorn.error - INFO - ('127.0.0.1', 63512) - "WebSocket /ws/metaverse/agent/1/1" [accepted]
2025-05-27 18:18:54,523 - gameserver.ws.endpoints.component.metaverse_connection_manager - INFO - New connection established for ID 1
2025-05-27 18:18:54,524 - uvicorn.error - INFO - connection open
2025-05-27 18:19:06,134 - gameserver.ws.endpoints.metaverse - INFO - Received message message from env
2025-05-27 18:19:06,136 - gameserver.ws.endpoints.metaverse - INFO - Sending direct message from env to server None
2025-05-27 18:19:06,138 - gameserver.ws.endpoints.component.metaverse_connection_manager - WARNING - Invalid target type: server
2025-05-27 18:19:15,036 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from env
2025-05-27 18:19:24,530 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from agent
2025-05-27 18:19:32,015 - gameserver.ws.endpoints.metaverse - INFO - Received message message from env
2025-05-27 18:19:32,018 - gameserver.ws.endpoints.metaverse - INFO - Sending direct message from env to agent 1
2025-05-27 18:19:38,437 - gameserver.ws.endpoints.metaverse - INFO - Received message message from env
2025-05-27 18:19:38,441 - gameserver.ws.endpoints.metaverse - INFO - Sending direct message from env to agent 1
2025-05-27 18:19:45,037 - gameserver.ws.endpoints.metaverse - INFO - Received heartbeat message from env
2025-05-27 18:19:47,173 - gameserver.ws.endpoints.metaverse - INFO - WebSocket disconnected for env (env: 1, agent: None, human: None)
2025-05-27 18:19:47,177 - gameserver.ws.endpoints.component.metaverse_connection_manager - INFO - Disconnected env_id 1
2025-05-27 18:19:47,180 - uvicorn.error - INFO - connection closed
2025-05-27 18:19:51,528 - gameserver.ws.endpoints.metaverse - INFO - WebSocket disconnected for agent (env: 1, agent: 1, human: None)
2025-05-27 18:19:51,532 - gameserver.ws.endpoints.component.metaverse_connection_manager - INFO - Disconnected client 1 from 1
2025-05-27 18:19:51,535 - uvicorn.error - INFO - connection closed
